/**
 * wacp-frontend.min.js
 *
 * @author Your Inspiration Themes
 * @package YITH WooCommerce Added to Cart Popup
 * @version 1.0.0
 */
jQuery(document).ready(function(a){"use strict";if("undefined"!=typeof yith_wacp){var b=a("#yith-wacp-popup"),c=b.find(".yith-wacp-overlay"),d=b.find(".yith-wacp-close"),e=function(){a("html").removeClass("yith_wacp_open"),b.removeClass("open"),setTimeout(function(){b.find(".yith-wacp-content").html("")},1e3),a(document).trigger("yith_wacp_popup_after_closing")},f=function(){var c=b.find(".yith-wacp-wrapper"),d=a(window).width(),e=a(window).height(),f=d-60>yith_wacp.popup_size.width?yith_wacp.popup_size.width:d-60,g=e-120>yith_wacp.popup_size.height?yith_wacp.popup_size.height:e-120;c.css({left:d/2-f/2,top:e/2-g/2,width:f+"px",height:g+"px"})};a(window).on("resize yith_wacp_popup_changed",f),a("body").on("added_to_cart wacp_single_added_to_cart",function(c,d,h,i){"undefined"==typeof d&&(d=a.parseJSON(sessionStorage.getItem(wc_cart_fragments_params.fragment_name))),a.each(d,function(c,d){if("yith_wacp_message"==c){var h=b.find(".yith-wacp-content");return h.html(d),b.hasClass("open")?("undefined"!=typeof a.fn.perfectScrollbar&&h.perfectScrollbar("update"),h.scrollTop(0),a(document).trigger("yith_wacp_popup_changed",[b])):(a(document).trigger("yith_wacp_popup_before_opening",[b]),g(),f(),"undefined"!=typeof a.fn.perfectScrollbar&&b.find(".yith-wacp-content").perfectScrollbar({suppressScrollX:!0}),yith_wacp.is_mobile&&a("html").addClass("yith_wacp_open"),b.addClass("open"),b.find("a.continue-shopping").on("click",function(b){"#"==a(this).attr("href")&&(b.preventDefault(),e())}),a(document).trigger("yith_wacp_popup_after_opening",[b])),!1}})}),c.on("click",e),d.on("click",function(a){a.preventDefault(),e()});var g=function(){a(document).on("click",".yith-wacp-remove-cart",function(c){c.preventDefault();var d=a(this).parents("table"),e={action:yith_wacp.actionremove,item_key:a(this).data("item_key"),context:"frontend"};d.block({message:null,overlayCSS:{background:"#fff url("+yith_wacp.loader+") no-repeat center",opacity:.5,cursor:"none"}}),a.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionremove),data:e,dataType:"html",success:function(c){b.find(".yith-wacp-content").html(c),a(document).trigger("yith_wacp_popup_changed",[b])}})})},h=a(yith_wacp.form_selectors);h.on("submit",function(b){if("undefined"!=typeof wc_cart_fragments_params&&yith_wacp.enable_single){var c,d=!1,e=a(this),f=e.find('button[type="submit"]'),g=e.find('input[name="yith-wacp-is-excluded"]');try{c="sessionStorage"in window&&null!==window.sessionStorage,window.sessionStorage.setItem("wc","test"),window.sessionStorage.removeItem("wc")}catch(a){c=!1,a.code==DOMException.QUOTA_EXCEEDED_ERR&&0==window.sessionStorage.length&&(d=!0)}if(!g.length&&!d){b.preventDefault(),a(document).trigger("yith_wacp_adding_cart_single"),f.addClass("loading").removeClass("added");var h=e.serializeArray();h.push({name:"action",value:yith_wacp.actionadd},{name:"context",value:"frontend"}),a.ajax({url:yith_wacp.ajaxurl.toString().replace("%%endpoint%%",yith_wacp.actionadd),data:a.param(h),dataType:"json",type:"POST",success:function(b){if(b.msg)return e.parents("div.product").before(b.msg),a("body").animate({scrollTop:0},500),f.removeAttr("disabled").removeClass("loading"),!1;var d,g={product_id:b.prod_id,variation_id:b.variation_id,ywacp_is_single:"yes",context:"frontend"};"undefined"!=typeof wc_cart_fragments_params.wc_ajax_url?d=wc_cart_fragments_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"):(d=wc_cart_fragments_params.ajax_url,g.action="woocommerce_get_refreshed_fragments"),a.ajax({url:d,type:"POST",data:g,success:function(b){b&&b.fragments&&(a.each(b.fragments,function(b,c){a(b).replaceWith(c)}),c&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(b.fragments)),sessionStorage.setItem("wc_cart_hash",b.cart_hash)),a("body").trigger("wc_fragments_refreshed").trigger("wacp_single_added_to_cart"),f.removeAttr("disabled").removeClass("loading").addClass("added"))}})}})}}}),a(document).on("yith_wacp_popup_after_opening yith_wacp_popup_changed",function(){"undefined"!=typeof a.yith_wccl&&"undefined"!=typeof a.fn.wc_variation_form&&(a(document).find(".variations_form:not(.initialized)").each(function(){a(this).wc_variation_form()}),a.yith_wccl())})}});
